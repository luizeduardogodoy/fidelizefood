<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8"/>
	<meta name="format-detection" content="telephone=no" />
	<meta name="msapplication-tap-highlight" content="no" />
	<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
	
	<meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline'; style-src 'self' 'unsafe-inline';media-src *" />
	
	<link rel="stylesheet" href="css/normalize.css">
	<link rel="stylesheet" href="css/foundation.css">
	
	<link rel="stylesheet" href="css/app.css">
	<script src="js/vendor/modernizr.js"></script>
	

</head>

<body>
	<div class="row">
		<div style="background:#521474;margin-bottom:5px" class="small-12 columns panel" align="center">
			<h1 style="color:white">FIDELIZEFOOD</h1>
		</div>
		<div style="background:white;" class ="small-12 columns panel" align="center">
			<h1 style="color:#521474">Cadastro de Restaurante</h1>		
		</div>
		<div class="small-12 large-6 columns">	
			<label for="user">Nome Fantasia:
				<input type="text" name="nomeFantasia" id="nomeFantasia"/>
			</label>
			<small style="display:none">Informar nome</small>
		</div>
		
		<div class="small-12 large-6 columns">
			<label for="user">CNPJ:
				<input type="text" name="cnpj" id="cnpj"/>
			</label>
			<small style="display:none">Informar cnpj</small>
		</div>
		<div class="small-12 large-6 columns">
			<label for="user">Estado:
				<select name="estado" id="estado">
					<option></option>
					<option value="PR">Paraná</option>
					
				</select>
			</label>
			<small style="display:none">Selecione</small>
		</div>
		<div class="small-12 large-6 columns">
			<label for="user">Cidade:
				<select name="cidade" id="cidade">
					<option></option>
					<option value="Curitiba">Curitiba</option>
					<option value="Pinhais">Pinhais</option>
					<option value="São José dos Pinhais">São José dos Pinhais</option>
				</select>
			</label>
			<small style="display:none">Selecione</small>
		</div>
		<div class="small-12 large-6 columns">
			<label for="user">Endereço:
				<input type="text" name="endereco" id="endereco"/>
			</label>
			<small style="display:none">Informar endereço</small>
		</div>
		<div class="small-12 large-6 columns">
			<label for="user">Telefone:
				<input type="text" name="telefone" id="telefone"/>
			</label>
			<small style="display:none">Informar telefone</small>
		</div>
		
		<div class="small-12 large-6 columns">
				<input type="submit" onclick="enviar()" class="button radius expand"/>
		</div>
	</div>
	
	
	<script type="text/javascript" src="cordova.js"></script>
	<script src="js/vendor/jquery.js"></script>
	<script src="js/foundation.min.js"></script>
	<script src="js/foundation/foundation.topbar.js"></script>	
	 
	<script type="text/javascript">

		$(document).foundation();
			
		
		function enviar(){
			
			//recupera os dados do usuário logado
			var retrieveInfo = window.sessionStorage.getItem("info");
			var parsedInfo = JSON.parse(retrieveInfo);
			var rest = {};

			rest.name  = $("#nomeFantasia").val();
			rest.cnpj  = $("#cnpj").val();
			rest.state = $("#estado").val();
			rest.city  = $("#cidade").val();
			rest.address  = $("#endereco").val();
			rest.phone  = $("#telefone").val();
			rest.idusuario = parsedInfo[0];
			rest.req   = "cadastrorestaurant";
			
			/*FAZER UMA VALIDAÇÃO NO FORM*/
			$("input, select").each(function(){
				
				
				if($(this).val() == "" ){
					//$(this).parent("label").addClass("error");
				}
			
			});
			
			//$.post("http://softprevirpps/code/public_html/index.php",
			
			$.post("http://localhost/FidelizeFood/public_html/index.php", rest, 
				function(response){
					
					var obj = $.parseJSON(response);
					alert (obj);

					if(obj.status == "!ok" ){
						alert("Não foi possivel cadastrar o restaurante");
					}
					else{
						alert("Restaurante cadastrado com sucesso!");
						
						var details = new Array();
						details = [$("#nomeFantasia").val(), $("#cnpj").val(),$("#phone").val()];
						window.sessionStorage.setItem("info", JSON.stringify(details));
					
						window.location.href = "index.html";
					}
				}
			);
		}

		function init(){
			mudar();
		}
		
		function mudar(){
			StatusBar.show();
			StatusBar.backgroundColorByHexString("#521474");
		}

		document.addEventListener('deviceready', init, false);					 

	</script>
	
	
</body>


</html>

